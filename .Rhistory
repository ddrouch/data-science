gg<-ggplot(at,aes(x=MonthlyIncome))
gg<-gg+geom_histogram(fill = "steelblue4", binwidth = 1000)
gg
```{r}
mi_sum<-at%>%
group_by(EducationField)%>%
summarize(mi_avg=mean(MonthlyIncome))
at_sum
mi_sum
View(mi_sum)
## Create bar plot with aesthetics: mean monthly income as y, education field as x
gg<-ggplot(mi_sum,aes(x=EducationField,y=mi_avg))
## Use bar plot geometry, height of bars set by level observed in dataset
gg<-gg+geom_bar(stat="Identity", fill="steelblue3", color="steelblue4")
## Print
gg
## Create bar plot with aesthetics: mean monthly income as y, education field as x
gg<-ggplot(mi_sum,aes(x=fct_reorder(EducationField,mi_avg),y=mi_avg))
## Use bar plot geometry, height of bars set by level observed in dataset
gg<-gg+geom_bar(stat="Identity", fill="steelblue4")
## Labeling
gg<-gg+xlab("Field")+ylab("Average Monthly Income")
## Print
gg
## Summarize monthly income by field of educcation -and- gender
mi_sum2<-at%>%
group_by(EducationField,Gender)%>%
summarize(mi_avg=mean(MonthlyIncome))
## Print the results
mi_sum2
## PLot it using a bar plot
gg<-ggplot(at_sum,aes(x=fct_reorder(BusinessTravel,attr_avg),y=attr_avg,color=Gender))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(forcats)
library(RColorBrewer)
library(knitr)
load("attrition.Rdata")
## Crate a new variable named attrit and define it as 0
at<-at%>%mutate(attrit=ifelse(Attrition=="Yes",1,0))
table(at$Attrition)
table(at$attrit)
table(at$attrit,at$Attrition)
gg<-ggplot(at,aes(x=Department,fill=Department))
gg<-gg+geom_bar()
gg
gg<-ggplot(at,aes(x=DistanceFromHome))
gg<-gg+geom_histogram(binwidth = 1)
gg
gg<-ggplot(at,aes(x=DistanceFromHome))
gg<-gg+geom_density()
gg
## Changing bandwidth-- not recommended, just showing you how.
gg<-gg+geom_density(bw=10)
gg
at_sum<-at%>%
group_by(BusinessTravel)%>%
summarize(attr_avg=mean(attrit))
at_sum
at %>%
count(BusinessTravel,attrit) %>%
group_by(BusinessTravel)%>%
mutate(prop = prop.table(n)) %>%
select(-n) %>%
spread(attrit, prop)%>%kable()
## Bar Plot with aesthetics: mean attrition as height, business travel as cateogry
gg<-ggplot(at_sum,aes(x=BusinessTravel,y=attr_avg))
## Use bar plot geometry, height of bars set by level observed in dataset
gg<-gg+geom_bar(stat="Identity", fill="gold", color="black")
## Print
gg
## Same asethetics, but now orderred by level
gg<-ggplot(at_sum,aes(x=fct_reorder(BusinessTravel,attr_avg),y=attr_avg))
gg<-gg+geom_bar(stat="identity")
## Labeling
gg<-gg+xlab("Amount of Travel")+ylab("Yearly Attrition")
##Print
gg
at_sum2<-at%>%
group_by(Department)%>%
summarize(attr_avg=mean(attrit))
## Same asethetics, but now orderred by level
gg<-ggplot(at_sum2,aes(x=fct_reorder(Department,attr_avg),y=attr_avg))
gg<-gg+geom_bar(stat="identity")
## Labeling
gg<-gg+xlab("Department")+ylab("Yearly Attrition")
##Print
gg
at_sum<-at%>%
group_by(BusinessTravel)%>%
summarize(attr_avg=mean(attrit))
at_sum
## Now a dot plot
gg<-ggplot(at_sum,aes(x=reorder(BusinessTravel,-attr_avg),y=attr_avg))
gg<-gg+geom_point(color="steelblue4",size=5)
gg<-gg+xlab("Travel")+ylab("Average Attrition")
gg<-gg+coord_flip()
gg
## Summarize attrition by travel AND gender
at_sum<-at%>%
group_by(BusinessTravel,Gender)%>%
summarize(attr_avg=mean(attrit))
## Get the results
at_sum
## PLot it using a bar plot
gg<-ggplot(at_sum,aes(x=fct_reorder(BusinessTravel,attr_avg),y=attr_avg,color=Gender))
gg<-gg+geom_bar(stat="identity",aes(fill=Gender),position="dodge")
gg<-gg+ylab("Pr(Attrition)")+xlab("Frequency of Travel")
gg
## Clear environment
rm(list=ls())
## Get libraries
library(knitr)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(plotly)
library(Metrics)
## Load in the attrition dataset
load("/Users/derekrouch/Documents/GitHub/data-science/attrition.Rdata")
## Create histogram of monthly income width bindwidth of 1,000
gg<-ggplot(at,aes(x=MonthlyIncome))
gg<-gg+geom_histogram(fill = "steelblue4", binwidth = 1000)
gg
## Group by field of education and summarize mean monthly income
mi_sum<-at%>%
group_by(EducationField)%>%
summarize(mi_avg=mean(MonthlyIncome))
## Print new dataset
mi_sum
## Create bar plot with mean monthly income as y, education field as x. Order from low to high
gg<-ggplot(mi_sum,aes(x=fct_reorder(EducationField,mi_avg),y=mi_avg))
## Use bar plot geometry, height of bars set by level observed in dataset
gg<-gg+geom_bar(stat="Identity", fill="steelblue4")
## Label axes
gg<-gg+xlab("Field")+ylab("Average Monthly Income")
## Print graph
gg
## Summarize monthly income by field of educcation -and- gender
mi_sum2<-at%>%
group_by(EducationField,Gender)%>%
summarize(mi_avg=mean(MonthlyIncome))
## Print the results
mi_sum2
## Plot it using a bar plot
gg<-ggplot(mi_sum2,aes(x=fct_reorder(EducationField,mi_avg),y=mi_avg,color=Gender))
gg<-gg+geom_bar(stat="identity",aes(fill=Gender),position="dodge")
gg<-gg+ylab("Average Monthly Income")+xlab("Field")
gg
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(forcats)
library(RColorBrewer)
library(knitr)
load("attrition.Rdata")
## Crate a new variable named attrit and define it as 0
at<-at%>%mutate(attrit=ifelse(Attrition=="Yes",1,0))
table(at$Attrition)
table(at$attrit)
table(at$attrit,at$Attrition)
gg<-ggplot(at,aes(x=Department,fill=Department))
gg<-gg+geom_bar()
gg
gg<-ggplot(at,aes(x=DistanceFromHome))
gg<-gg+geom_histogram(binwidth = 1)
gg
gg<-ggplot(at,aes(x=DistanceFromHome))
gg<-gg+geom_density()
gg
## Changing bandwidth-- not recommended, just showing you how.
gg<-gg+geom_density(bw=10)
gg
at_sum<-at%>%
group_by(BusinessTravel)%>%
summarize(attr_avg=mean(attrit))
at_sum
at %>%
count(BusinessTravel,attrit) %>%
group_by(BusinessTravel)%>%
mutate(prop = prop.table(n)) %>%
select(-n) %>%
spread(attrit, prop)%>%kable()
## Bar Plot with aesthetics: mean attrition as height, business travel as cateogry
gg<-ggplot(at_sum,aes(x=BusinessTravel,y=attr_avg))
## Use bar plot geometry, height of bars set by level observed in dataset
gg<-gg+geom_bar(stat="Identity", fill="gold", color="black")
## Print
gg
## Same asethetics, but now orderred by level
gg<-ggplot(at_sum,aes(x=fct_reorder(BusinessTravel,attr_avg),y=attr_avg))
gg<-gg+geom_bar(stat="identity")
## Labeling
gg<-gg+xlab("Amount of Travel")+ylab("Yearly Attrition")
##Print
gg
at_sum2<-at%>%
group_by(Department)%>%
summarize(attr_avg=mean(attrit))
## Same asethetics, but now orderred by level
gg<-ggplot(at_sum2,aes(x=fct_reorder(Department,attr_avg),y=attr_avg))
gg<-gg+geom_bar(stat="identity")
## Labeling
gg<-gg+xlab("Department")+ylab("Yearly Attrition")
##Print
gg
at_sum<-at%>%
group_by(BusinessTravel)%>%
summarize(attr_avg=mean(attrit))
at_sum
## Now a dot plot
gg<-ggplot(at_sum,aes(x=reorder(BusinessTravel,-attr_avg),y=attr_avg))
gg<-gg+geom_point(color="steelblue4",size=5)
gg<-gg+xlab("Travel")+ylab("Average Attrition")
gg<-gg+coord_flip()
gg
## Summarize attrition by travel AND gender
at_sum<-at%>%
group_by(BusinessTravel,Gender)%>%
summarize(attr_avg=mean(attrit))
## Get the results
at_sum
## Plot it using a bar plot
gg<-ggplot(at_sum,aes(x=fct_reorder(BusinessTravel,attr_avg),y=attr_avg,color=Gender))
gg<-gg+geom_bar(stat="identity",aes(fill=Gender),position="dodge")
gg<-gg+ylab("Pr(Attrition)")+xlab("Frequency of Travel")
gg
## Plot it using a dot plot
gg<-ggplot(at_sum,aes(x=reorder(BusinessTravel,attr_avg),y=attr_avg),color=Gender)
gg<-gg+geom_point(aes(color=Gender),size=5)
gg<-gg+coord_flip()
gg
## Plot it using a dot plot
gg<-ggplot(at_sum,aes(x=reorder(Department,attr_avg),y=attr_avg),color=EducationField)
gg<-gg+geom_point(aes(color=EducationField),size=4)
gg<-gg+coord_flip()
gg
View(at_sum)
## Plot it using a dot plot
at_sum2<-at%>%
group_by(Department,EducationField)%>%
summarize(attr_avg=mean(attrit))
gg<-ggplot(at_sum2,aes(x=reorder(Department,attr_avg),y=attr_avg),color=EducationField)
gg<-gg+geom_point(aes(color=EducationField),size=4)
gg<-gg+coord_flip()
gg
## Load in the attrition dataset
load("attrition.Rdata")
setwd("~/Documents/GitHub/data-science")
## Clear environment
rm(list=ls())
## Get libraries
library(knitr)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(plotly)
library(Metrics)
## Set working director
setwd("~/Documents/GitHub/data-science")
## Load in the attrition dataset
load("attrition.Rdata")
load("~/Documents/GitHub/data-science/attrition.Rdata")
## Load in the attrition dataset
load("~/Documents/GitHub/data-science/attrition.Rdata")
## Create histogram of monthly income width bindwidth of 1,000
gg<-ggplot(at,aes(x=MonthlyIncome))
gg<-gg+geom_histogram(fill = "steelblue4", binwidth = 1000)
gg
## Group by field of education and summarize mean monthly income
mi_sum<-at%>%
group_by(EducationField)%>%
summarize(mi_avg=mean(MonthlyIncome))
## Print new dataset
mi_sum
## Create bar plot with mean monthly income as y, education field as x. Order from low to high
gg<-ggplot(mi_sum,aes(x=fct_reorder(EducationField,mi_avg),y=mi_avg))
## Use bar plot geometry, height of bars set by level observed in dataset
gg<-gg+geom_bar(stat="Identity", fill="steelblue4")
## Label axes
gg<-gg+xlab("Field")+ylab("Average Monthly Income")
## Print graph
gg
## Summarize monthly income by field of educcation -and- gender
mi_sum2<-at%>%
group_by(EducationField,Gender)%>%
summarize(mi_avg=mean(MonthlyIncome))
## Print the results
mi_sum2
## Plot it using a bar plot
gg<-ggplot(mi_sum2,aes(x=fct_reorder(EducationField,mi_avg),y=mi_avg,color=Gender))
gg<-gg+geom_bar(stat="identity",aes(fill=Gender),position="dodge")
gg<-gg+ylab("Average Monthly Income")+xlab("Field")
gg
## Changing Colors
mypal<-c("lightblue","orange")
gg<-gg+scale_fill_manual(values =mypal )
gg<-gg+scale_color_manual(values =mypal )
## Print
gg
gg<-gg+scale_color_manual(values =mypal )
## Print
gg
## Another way, using color brewer palettes:
gg<-gg+scale_fill_brewer(palette = "Set1")
gg
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(forcats)
library(RColorBrewer)
library(knitr)
load("attrition.Rdata")
## Crate a new variable named attrit and define it as 0
at<-at%>%mutate(attrit=ifelse(Attrition=="Yes",1,0))
table(at$Attrition)
table(at$attrit)
table(at$attrit,at$Attrition)
gg<-ggplot(at,aes(x=Department,fill=Department))
gg<-gg+geom_bar()
gg
gg<-ggplot(at,aes(x=DistanceFromHome))
gg<-gg+geom_histogram(binwidth = 1)
gg
gg<-ggplot(at,aes(x=DistanceFromHome))
gg<-gg+geom_density()
gg
## Changing bandwidth-- not recommended, just showing you how.
gg<-gg+geom_density(bw=10)
gg
at_sum<-at%>%
group_by(BusinessTravel)%>%
summarize(attr_avg=mean(attrit))
at_sum
at %>%
count(BusinessTravel,attrit) %>%
group_by(BusinessTravel)%>%
mutate(prop = prop.table(n)) %>%
select(-n) %>%
spread(attrit, prop)%>%kable()
## Bar Plot with aesthetics: mean attrition as height, business travel as cateogry
gg<-ggplot(at_sum,aes(x=BusinessTravel,y=attr_avg))
## Use bar plot geometry, height of bars set by level observed in dataset
gg<-gg+geom_bar(stat="Identity", fill="gold", color="black")
## Print
gg
## Same asethetics, but now orderred by level
gg<-ggplot(at_sum,aes(x=fct_reorder(BusinessTravel,attr_avg),y=attr_avg))
gg<-gg+geom_bar(stat="identity")
## Labeling
gg<-gg+xlab("Amount of Travel")+ylab("Yearly Attrition")
##Print
gg
at_sum2<-at%>%
group_by(Department)%>%
summarize(attr_avg=mean(attrit))
## Same asethetics, but now orderred by level
gg<-ggplot(at_sum2,aes(x=fct_reorder(Department,attr_avg),y=attr_avg))
gg<-gg+geom_bar(stat="identity")
## Labeling
gg<-gg+xlab("Department")+ylab("Yearly Attrition")
##Print
gg
at_sum<-at%>%
group_by(BusinessTravel)%>%
summarize(attr_avg=mean(attrit))
at_sum
## Now a dot plot
gg<-ggplot(at_sum,aes(x=reorder(BusinessTravel,-attr_avg),y=attr_avg))
gg<-gg+geom_point(color="steelblue4",size=5)
gg<-gg+xlab("Travel")+ylab("Average Attrition")
gg<-gg+coord_flip()
gg
## Summarize attrition by travel AND gender
at_sum<-at%>%
group_by(BusinessTravel,Gender)%>%
summarize(attr_avg=mean(attrit))
## Get the results
at_sum
## Plot it using a bar plot
gg<-ggplot(at_sum,aes(x=fct_reorder(BusinessTravel,attr_avg),y=attr_avg,color=Gender))
gg<-gg+geom_bar(stat="identity",aes(fill=Gender),position="dodge")
gg<-gg+ylab("Pr(Attrition)")+xlab("Frequency of Travel")
gg
## Plot it using a dot plot
gg<-ggplot(at_sum,aes(x=reorder(BusinessTravel,attr_avg),y=attr_avg),color=Gender)
gg<-gg+geom_point(aes(color=Gender),size=5)
gg<-gg+coord_flip()
gg
## Plot it using a dot plot
at_sum2<-at%>%
group_by(Department,EducationField)%>%
summarize(attr_avg=mean(attrit))
gg<-ggplot(at_sum2,aes(x=reorder(Department,attr_avg),y=attr_avg),color=EducationField)
gg<-gg+geom_point(aes(color=EducationField),size=4)
gg<-gg+coord_flip()
gg
## Changing Colors
mypal<-c("lightblue","orange")
gg<-gg+scale_fill_manual(values =mypal )
gg<-gg+scale_color_manual(values =mypal )
## Print
gg
at_sum<-at%>%
group_by(BusinessTravel,Gender,MaritalStatus)%>%
summarize(attr_avg=mean(attrit))%>%
arrange(-attr_avg)
at_sum
gg<-ggplot(at_sum,aes(x=reorder(BusinessTravel,attr_avg),
y=attr_avg,
fill=Gender))
## Bar plot, with unstacked (dodge)
gg<-gg+geom_bar(stat="identity",position="dodge")
## Separate out by Marital Status
gg<-gg+facet_wrap(~MaritalStatus)
## Change orientation to sideways
gg<-gg+coord_flip()
## Print
gg
at_sum<-at%>%
group_by(BusinessTravel,Gender,MaritalStatus,WorkLifeBalance)%>%
summarize(attr_avg=mean(attrit))%>%
ungroup()%>%
arrange(attr_avg)
at_sum
View(at_sum)
gg<-ggplot(at_sum,aes(x=fct_reorder(BusinessTravel,attr_avg),y=attr_avg))
gg<-gg+geom_bar(stat="identity",aes(fill=MaritalStatus),position="dodge")
gg<-gg+facet_wrap(~Gender+WorkLifeBalance,ncol=4)
gg<-gg+ylab("Proportion of Employees Who Departed")+xlab("Category")
gg<-gg+theme(axis.text.x = element_text(angle = 60, hjust = 1))
gg<-gg+ggtitle("Departure by Gender and Level of Work/Life Satisfaction")
gg
at_sum3<-at%>%
group_by(EducationField,Department,Gender)%>%
summarize(attr_avg=mean(attrit))%>%
arrange(-attr_avg)
at_sum3
gg<-ggplot(at_sum,aes(x=reorder(EducationField,attr_avg),
y=attr_avg,
fill=Gender))
## Bar plot, with unstacked (dodge)
gg<-gg+geom_bar(stat="identity",position="dodge")
## Separate out by Marital Status
gg<-gg+facet_wrap(~Department)
## Change orientation to sideways
gg<-gg+coord_flip()
## Print
gg
gg<-ggplot(at_sum3aes(x=reorder(EducationField,attr_avg),
y=attr_avg,
fill=Gender))
gg<-ggplot(at_sum3,aes(x=reorder(EducationField,attr_avg),
y=attr_avg,
fill=Gender))
## Bar plot, with unstacked (dodge)
gg<-gg+geom_bar(stat="identity",position="dodge")
## Separate out by Marital Status
gg<-gg+facet_wrap(~Department)
## Change orientation to sideways
gg<-gg+coord_flip()
## Print
gg
mi_sum3<-at%>%
group_by(EducationField,Gender,JobLevel)%>%
summarize(mi_avg=mean(MonthlyIncome))%>%
arrange(MonthlyIncome)
mi_sum3<-at%>%
group_by(EducationField,Gender,JobLevel)%>%
summarize(mi_avg=mean(MonthlyIncome))%>%
arrange(mi_avg)
View(mi_sum3)
mi_sum3<-at%>%
group_by(EducationField,Gender,JobLevel)%>%
summarize(mi_avg=mean(MonthlyIncome))%>%
arrange(-mi_avg)
View(mi_sum3)
View(mi_sum3)
## Plot it using a bar plot
gg<-ggplot(mi_sum3,aes(x=reorder(EducationField,mi_avg),
y=mi_avg,
fill=Gender))
## Bar plot, with unstacked (dodge)
gg<-gg+geom_bar(stat="identity",position="dodge")
## Separate out by Marital Status
gg<-gg+facet_wrap(~JobLevel)
## Change orientation to sideways
gg<-gg+coord_flip()
## Print
gg
## Plot it using a bar plot
gg<-ggplot(mi_sum3,aes(x=reorder(EducationField,mi_avg),
y=mi_avg,
fill=Gender))
## Unstack the bar plot
gg<-gg+geom_bar(stat="identity",position="dodge")
## Separate out by job level
gg<-gg+facet_wrap(~JobLevel)
## Flip the coordinates
gg<-gg+coord_flip()
## Label the axes
gg<-gg+ylab("Department")+xlab("Avg Monthly Income")
## Angle the x-axis text
gg<-gg+theme(axis.text.x = element_text(angle = 60, hjust = 1))
## Title the graph
gg<-gg+ggtitle("Monthly Income by Department and Gender, According to Job Level (1-5)")
## Print
gg
## Label the axes
gg<-gg+ylab("Avg Monthly Income")+xlab("Department")
## Angle the x-axis text
gg<-gg+theme(axis.text.x = element_text(angle = 60, hjust = 1))
## Title the graph
gg<-gg+ggtitle("Monthly Income by Department and Gender, According to Job Level (1-5)")
## Print
gg
